<div class="d-flex justify-content-between">
    <h2>{{'FEATURES.PRODUCTS.PRODUCTS' | translate}}</h2>
    @if(authService.isLoggedIn()){
        <a matButton color="primary" [routerLink]="'/products/new'">
            {{'FEATURES.PRODUCTS.ADD_PRODUCT' | translate}}
        </a>
    }
    
</div>


@if(productsService.loading()){
    <div class="d-flex justify-content-center p-5">
        <mat-spinner></mat-spinner>
    </div>
} @else if (productsService.gotError()) {
  <div class="alert alert-danger">
    {{'FEATURES.PRODUCTS.ERROR_LOADING' | translate}}
  </div>
} @else {

<div class="row">
        @for(product of filteredProducts(); track product.id){
                <div class="col-md-4 mb-4">
                    <mat-card [appHighlight]="'#914bc1'">
                        <a [routerLink]="['/products', product.id]" class="a-card-link">
                        <img 
                        mat-card-image 
                        [src]="product.image"
                        [alt]="product.title"
                        style="height: 200px; object-fit: contain; padding: 1rem;;"
                         />
                    
                    <mat-card-header>
                        <mat-card-title>{{product.title}}</mat-card-title>
                        <mat-card-subtitle>{{product.price | currency   }}</mat-card-subtitle>
                    </mat-card-header>
                    <mat-card-content>
                            <p>
                                {{  'FEATURES.PRODUCTS.RATE' | translate}}: 
                                {{ product.rating?.rate}}
                            </p>
                        </mat-card-content>
                        </a>
                    <mat-card-actions>
                        <button matButton [routerLink]="['/products', product.id]">
                            {{  'FEATURES.PRODUCTS.VIEW' | translate}}
                        </button>
                        <span class="spacer"></span>
                        @if(!latest()){
                            @if(authService.isLoggedIn()){ 
                                <button matIconButton (click)="deleteProduct(product.id)">
                                <mat-icon>delete</mat-icon>
                            </button>
                            }
                            <button matIconButton (click)="addToCart(product)">
                                <mat-icon>add_shopping_cart</mat-icon>
                            </button>
                        }
                    </mat-card-actions>
                    </mat-card>
                </div>
            }
</div>

}

